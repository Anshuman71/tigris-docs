const tigris: Tigris = new Tigris({
  serverUrl: "localhost:8081",
});

interface Review extends TigrisCollectionType {
  author: string;
  rating: number;
}

interface Catalog extends TigrisCollectionType {
  id?: number;
  name: string;
  price: number;
  brand: string;
  labels: string;
  popularity: number;
  reviews?: object;
}

const reviewSchema: TigrisSchema<Review> = {
  author: {
    type: TigrisDataTypes.STRING,
  },
  rating: {
    type: TigrisDataTypes.NUMBER,
  },
};

const catalogSchema: TigrisSchema<Catalog> = {
  id: {
    type: TigrisDataTypes.INT32,
    primary_key: {
      order: 1,
      autoGenerate: true,
    },
  },
  name: {
    type: TigrisDataTypes.STRING,
  },
  price: {
    type: TigrisDataTypes.NUMBER,
  },
  brand: {
    type: TigrisDataTypes.STRING,
  },
  labels: {
    type: TigrisDataTypes.STRING,
  },
  popularity: {
    type: TigrisDataTypes.INT32,
  },
  reviews: {
    type: reviewSchema,
  },
};

const db: DB = await tigris.createDatabaseIfNotExists("catalogdb");

const catalog: Collection<Catalog> = await db.createOrUpdateCollection(
  "catalog",
  catalogSchema
);